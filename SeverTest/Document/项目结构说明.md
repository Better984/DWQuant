# 项目结构说明

本文档简要说明服务器端各目录的主要作用，便于快速定位功能与代码范围。

## 根目录（SeverTest）
- `Modules/`：按业务模块拆分的主代码目录（见下方模块说明）。
- `Config/`：策略与功能的配置文件。
- `Document/`：项目文档与使用说明（含 `Protocol/` 协议文档）。
- `Properties/`：项目与构建相关的属性配置。
- `Startup/`：系统启动流程与中间件管道编排。
- `appsettings.json` / `appsettings.Development.json`：运行配置与环境配置。
- `Program.cs`：应用入口与依赖注入/中间件注册。
- `ServerTest.csproj` / `ServerTest.sln`：项目与解决方案文件。
- `PRICE_SUBSCRIPTION_README.md` / `README.md`：专项说明与总览文档。
- `bin/`、`obj/`：编译输出与中间文件。

## Modules 目录结构约定
- `Application/`：应用层服务、用例编排、业务流程入口。
- `Infrastructure/`：数据访问、第三方集成、外部系统适配。
- `Domain/`：领域模型与核心业务对象。
- `Sql/`：模块相关 SQL 片段或说明（如有）。
- `功能说明.md`：模块功能概述与联动关系说明。

## Modules 列表与职责
- `Accounts/`：账户鉴权、用户登录与交易设置。
- `AdminBroadcast/`：管理员广播与全局消息推送。
- `ExchangeApiKeys/`：交易所 API Key 管理。
- `MarketData/`：历史行情与行情维护。
- `MarketStreaming/`：行情订阅、WebSocket 行情推送与价格流。
- `Monitoring/`：系统启动监控与运行状态记录。
- `Notifications/`：通知渠道与用户通知偏好。
- `Positions/`：仓位与风控相关逻辑。
- `Shared/`：通用基础设施、公共模型与通用中间件。
- `StrategyEngine/`：策略核心执行与运行日志。
- `StrategyManagement/`：策略管理（增删改查、配置管理等）。
- `StrategyRuntime/`：策略运行时状态与调度。
- `TradingExecution/`：交易执行与下单流程。
- `WebSockets/`：WebSocket 基础设施与消息处理。

## 关键运行机制说明
- 启动流程：`Startup/SystemStartupWorkflow.cs` 负责启动步骤编排，`Startup/SystemPipeline.cs` 负责中间件管道配置。
- 策略多实例租约：`StrategyRuntime/StrategyOwnershipService` + `StrategyRuntimeLeaseHostedService` 通过 Redis 租约保证策略单实例执行，并支持接管与同步。
- 运行配置新增：`appsettings.json` 中新增 `Startup`（启动超时/预热）与 `StrategyOwnership`（租约/同步）配置项。
- 队列配置校验：`RuntimeQueue` 启动即校验容量与策略，避免误配置导致无界队列。
